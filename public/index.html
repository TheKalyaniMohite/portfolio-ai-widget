<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0"
  />
  <title>Kalyani Mohite Portfolio</title>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #1b1f2a;
      --bg2: #202532;
      --text: #f5f7fb;
      --muted: #c9ced8;
      --accent: #00e676;
      --accent2: #00b8d4;
      --black: #0f1116;
      --card: rgba(255,255,255,0.06);
      --card-border: rgba(255,255,255,0.12);
      --shadow: rgba(0,0,0,0.5);
    }

    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      color: var(--text);
      background: linear-gradient(180deg, #1b1f2a, #202532 40%, #1b1f2a);
      font-family: "Plus Jakarta Sans", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      overflow-x: hidden;
      scroll-behavior: smooth;
      scroll-padding-top: 100px;
    }

    body { padding-top: 72px; }

    a { color: inherit; text-decoration: none; }

    /* Top nav */
    .main-top-nav {
      position: fixed;
      top: 0; left: 0; right: 0;
      height: 72px;
      display: flex; align-items: center;
      background: rgba(0,0,0,0.85);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255,255,255,0.08);
      z-index: 1000;
      box-shadow: 0 4px 20px var(--shadow);
    }
    .nav-flex {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 18px;
      display: flex; align-items: center; justify-content: space-between;
    }
    .nav-left {
      display: flex; align-items: center; gap: 12px;
    }
    .nav-avatar {
      width: 40px; height: 40px; border-radius: 50%;
      border: 2px solid rgba(255,255,255,0.15);
      object-fit: cover;
      box-shadow: 0 6px 18px rgba(0,0,0,0.35);
    }
    .nav-name {
      font-weight: 700;
      letter-spacing: 0.3px;
    }
    .main-top-nav ul {
      display: flex; gap: 16px; list-style: none;
      margin: 0; padding: 0;
    }
    .main-top-nav li {
      padding: 6px 12px; border-radius: 10px;
      color: rgba(255,255,255,0.85);
      transition: all 0.2s ease;
      cursor: pointer;
    }
    .main-top-nav li:hover, .main-top-nav li.active {
      background: rgba(255,255,255,0.08);
      color: #fff;
      transform: translateY(-1px);
    }

    /* Hero */
    .section { padding: 60px 16px; }
    .hero {
      min-height: 78vh;
      display: flex; align-items: center; justify-content: center;
      padding-top: 40px;
    }
    .jumbotron {
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 18px;
      width: min(900px, 92%);
      padding: 36px 28px;
      box-shadow: 0 10px 36px rgba(0,0,0,0.35);
      text-align: center;
    }
    .hero-title {
      margin: 0 0 14px;
      font-size: clamp(26px, 5vw, 38px);
      font-weight: 800;
      letter-spacing: 1px;
      text-transform: uppercase;
      background: linear-gradient(45deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .hero-subtitle {
      margin: 0 auto;
      color: var(--muted);
      font-size: clamp(14px, 2.8vw, 18px);
      line-height: 1.7;
      max-width: 820px;
    }

    .social-row {
      display: flex; gap: 18px; justify-content: center; align-items: center;
      margin-top: 22px;
    }
    .social-link {
      width: 46px; height: 46px; border-radius: 50%;
      display: grid; place-items: center;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.15);
      color: var(--accent);
      line-height: 0;
      transition: transform 0.2s ease, background 0.2s ease;
    }
    .social-link:hover {
      transform: translateY(-2px) scale(1.03);
      background: rgba(0,230,118,0.15);
    }
    .social-link svg { width: 22px; height: 22px; }

    /* Section Titles */
    .section-title {
      text-align: center;
      font-weight: 800;
      font-size: clamp(20px, 4vw, 30px);
      margin: 10px auto 30px;
      background: linear-gradient(45deg, var(--accent), var(--accent2));
      -webkit-background-clip: text; background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* Cards */
    .card {
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 14px;
      padding: 18px;
      box-shadow: 0 12px 34px rgba(0,0,0,0.25);
    }

    /* Education */
    .education .education-box { margin: 14px auto; width: min(900px, 92%); }

    /* Experience */
    .experience .experience-box { margin: 14px auto; width: min(900px, 92%); }
    .experience-header { font-weight: 700; margin-bottom: 6px; }
    .experience-meta { color: var(--muted); font-size: 0.95rem; margin-bottom: 8px; }

    /* Projects */
    .projects .project-box { margin: 14px auto; width: min(900px, 92%); }
    .project-title { font-weight: 700; margin-bottom: 6px; }
    .project-details ul { margin: 0; padding-left: 18px; line-height: 1.55; }

    /* Skills */
    .skills { padding-top: 30px; }
    .skill-groups { width: min(1000px, 92%); margin: 0 auto; display: grid; gap: 18px; }
    .skill-group { padding: 18px; }
    .skill-group h3 { margin: 0 0 10px; font-size: 1.15rem; }
    .skill-tags { display: flex; flex-wrap: wrap; gap: 8px; }
    .tag {
      padding: 6px 10px; border-radius: 14px;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.15);
      font-size: 0.92rem; color: #e9eefb;
    }

    /* Dashboards */
    .dashboards .dashboard-card { margin: 14px auto; width: min(900px, 92%); }

    /* Back to Top */
    .back-to-top {
      position: fixed; right: 18px; bottom: 98px; width: 44px; height: 44px;
      border-radius: 50%; display: none; place-items: center;
      background: rgba(0,0,0,0.75);
      border: 1px solid rgba(255,255,255,0.15);
      color: #fff; font-size: 18px; cursor: pointer;
      z-index: 950;
    }
    .back-to-top.show { display: grid; }
    .back-to-top:hover { transform: translateY(-2px); }

    /* Floating AI Button & Widget */
    .floating-ai-button {
      position: fixed; right: 18px; bottom: 28px; width: 56px; height: 56px;
      border-radius: 50%; display: grid; place-items: center; cursor: pointer;
      background: linear-gradient(45deg, var(--accent), var(--accent2));
      border: 0; color: #111; font-size: 22px;
      box-shadow: 0 12px 34px rgba(0,0,0,0.35);
      z-index: 1002;
    }
    .floating-ai-button:hover { transform: translateY(-2px) scale(1.02); }

    .ai-widget {
      position: fixed; right: 18px; bottom: 96px; width: min(420px, 92vw);
      max-height: 70vh; display: flex; flex-direction: column;
      background: rgba(27,31,42,0.96);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 14px;
      box-shadow: 0 14px 48px rgba(0,0,0,0.45);
      overflow: hidden; opacity: 0; visibility: hidden; transform: translateY(10px) scale(0.98);
      transition: all 0.18s ease-out;
      z-index: 1001;
    }
    .ai-widget.open { opacity: 1; visibility: visible; transform: translateY(0) scale(1); }
    .ai-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 12px;
      background: rgba(255,255,255,0.07);
      border-bottom: 1px solid rgba(255,255,255,0.1);
      font-weight: 700;
    }
    .ai-header .title { display: flex; align-items: center; gap: 10px; }
    .ai-close { border: 0; background: transparent; color: #fff; font-size: 18px; cursor: pointer; }

    .ai-body {
      display: flex; flex-direction: column;
      padding: 10px; gap: 10px; overflow-y: auto; min-height: 140px;
    }
    .ai-typing { font-size: 0.9rem; color: var(--muted); padding-left: 6px; display: none; }
    .ai-typing.show { display: block; }

    /* Chat bubbles */
    .chat {
      display: flex; flex-direction: column; gap: 8px;
    }
    .bubble {
      max-width: 85%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.06);
      line-height: 1.45;
      position: relative;
    }
    .bubble.user {
      background: rgba(0,184,212,0.15);
      align-self: flex-end;
      border-color: rgba(0,184,212,0.35);
    }
    .bubble.ai {
      align-self: flex-start;
      background: rgba(0,230,118,0.12);
      border-color: rgba(0,230,118,0.28);
    }
    .bubble .ts {
      position: absolute; bottom: -16px; right: 8px; font-size: 10px; color: var(--muted);
    }

    /* Suggestions */
    .suggestions {
      display: grid; gap: 6px; grid-template-columns: 1fr 1fr;
    }
    .suggestions .chip {
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.15);
      border-radius: 10px;
      padding: 8px 10px; font-size: 0.9rem; cursor: pointer;
    }
    .suggestions .chip:hover { background: rgba(0, 230, 118, 0.15); }

    .ai-footer {
      display: grid; gap: 8px; padding: 10px; border-top: 1px solid rgba(255,255,255,0.1);
    }

    .input-row {
      display: grid; grid-template-columns: 1fr auto; gap: 8px;
      align-items: flex-end;
    }
    .ai-textarea {
      width: 100%;
      min-height: 42px; max-height: 160px;
      padding: 10px 12px; border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.15);
      resize: none; overflow: hidden;  /* no scrollbars */
      background: rgba(255,255,255,0.06);
      color: #fff; font-size: 0.95rem; line-height: 1.3;
    }
    .send-btn {
      width: 44px; height: 44px; border-radius: 10px; border: 0; cursor: pointer;
      background: linear-gradient(45deg, var(--accent), var(--accent2));
      color: #111; font-size: 20px;
      display: grid; place-items: center;
    }

    .sub-row {
      display: flex; justify-content: space-between; align-items: center;
    }
    .clear-btn {
      border: 0; background: rgba(255,255,255,0.08);
      color: #fff; padding: 6px 10px; border-radius: 8px; cursor: pointer;
      border: 1px solid rgba(255,255,255,0.15);
      font-size: 0.9rem;
    }
    .clear-btn:hover { background: rgba(255,255,255,0.12); }

    @media (max-width: 640px) {
      .main-top-nav ul { display: none; }
      .jumbotron { padding: 24px 16px; }
    }
  </style>
</head>

<body>
  <!-- NAV -->
  <nav class="main-top-nav" id="mainTopNav">
    <div class="nav-flex">
      <div class="nav-left">
        <img src="final_profile.jpg" alt="Kalyani" class="nav-avatar" />
        <div class="nav-name">Kalyani Mohite</div>
      </div>
      <ul>
        <li><a href="#home">Home</a></li>
        <li><a href="#education">Education</a></li>
        <li><a href="#experience">Experience</a></li>
        <li><a href="#projects">Projects</a></li>
        <li><a href="#skills">Skills</a></li>
        <li><a href="#dashboards">Dashboards</a></li>
      </ul>
    </div>
  </nav>

  <!-- HERO -->
  <section id="home" class="hero section">
    <div class="jumbotron">
      <h1 class="hero-title">HELLO, I AM KALYANI MOHITE</h1>
      <p class="hero-subtitle">
        AI-Driven Data Analyst dedicated to transforming complex data into actionable insights and strategic narratives.
      </p>

      <div class="social-row">
        <a class="social-link" href="https://www.linkedin.com/in/kalyanimohite26/" target="_blank" title="LinkedIn" aria-label="LinkedIn">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 0H5C2.2 0 0 2.2 0 5V19C0 21.8 2.2 24 5 24H19C21.8 24 24 21.8 24 19V5C24 2.2 21.8 0 19 0zM7.1 20.5H3.9V9.3H7.1V20.5zM5.5 7.8C4.3 7.8 3.3 6.8 3.3 5.6C3.3 4.3 4.3 3.3 5.5 3.3C6.7 3.3 7.7 4.3 7.7 5.6C7.7 6.8 6.7 7.8 5.5 7.8zM20.5 20.5H17.3V14.9C17.3 13.5 17.3 11.8 15.4 11.8C13.5 11.8 13.2 13.1 13.2 14.8V20.5H10.1V9.3H13.2V10.8H13.3C13.7 10 14.7 9.1 16.2 9.1C19.2 9.1 20.5 11 20.5 13.9V20.5Z"></path></svg>
        </a>
        <a class="social-link" href="mailto:kmohite@gmu.edu" title="Email" aria-label="Email">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 13L0 6V4L12 11L24 4V6L12 13ZM0 8V20H24V8L12 15L0 8Z"></path></svg>
        </a>
        <a class="social-link" href="https://github.com/TheKalyaniMohite" target="_blank" title="GitHub" aria-label="GitHub">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 .5C5.7.5.8 5.4.8 11.7c0 4.9 3.2 9 7.6 10.4.6.1.8-.3.8-.6v-2.2c-3.1.7-3.8-1.3-3.8-1.3-.5-1.1-1.1-1.4-1.1-1.4-.9-.6.1-.6.1-.6 1 .1 1.6 1 1.6 1 .9 1.5 2.3 1 2.9.8.1-.6.3-1 .6-1.3C8 15.7 5.8 14.8 5.8 11.3c0-1 .4-1.8 1-2.4-.1-.2-.5-1.3.1-2.6 0 0 .8-.3 2.7 1 1.6-.4 3.3-.4 4.9 0 1.9-1.3 2.7-1 2.7-1 .6 1.3.2 2.4.1 2.6.6.6 1 1.4 1 2.4 0 3.5-2.2 4.4-4.3 4.6.4.3.7.9.7 1.8v2.7c0 .3.2.7.9.6 4.4-1.4 7.6-5.5 7.6-10.4C23.2 5.4 18.3.5 12 .5z"/></svg>
        </a>
        <a class="social-link" href="tel:7048868432" title="Phone" aria-label="Phone">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M6.5 10.8c1.8 3.7 4.9 6.6 8.6 8.6l2.2-2.2c.3-.3.8-.4 1.2-.3 1.1.4 2.3.6 3.5.6.6 0 1 .4 1 1V22c0 .6-.4 1-1 1C10.5 23 1 13.5 1 2c0-.6.4-1 1-1h3.5c.6 0 1 .4 1 1 0 1.3.2 2.5.6 3.6.1.4 0 .8-.3 1.1L6.5 10.8z"/></svg>
        </a>
      </div>
    </div>
  </section>

  <!-- EDUCATION -->
  <section id="education" class="section education">
    <h2 class="section-title">Education</h2>
    <div class="education-box card edu-context">
      <div class="education-header"><strong>MASTER OF SCIENCE</strong></div>
      <div class="education-details">
        <ul>
          <li><strong>Degree:</strong> Master of Science in Computer Science</li>
          <li><strong>School:</strong> George Mason University</li>
          <li><strong>Duration:</strong> Aug 2023 – May 2025</li>
          <li><strong>GPA:</strong> 3.9</li>
          <li><strong>Relevant Coursework:</strong> Machine Learning, Generative AI, Data Mining, Advanced Algorithm Analysis, Software Development</li>
        </ul>
      </div>
    </div>

    <div class="education-box card edu-context">
      <div class="education-header"><strong>BACHELOR OF ENGINEERING</strong></div>
      <div class="education-details">
        <ul>
          <li><strong>Degree:</strong> B.E. in Computer Science and Engineering</li>
          <li><strong>School:</strong> University of Pune</li>
          <li><strong>Duration:</strong> Aug 2018 – July 2022</li>
          <li><strong>GPA:</strong> 3.5</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- EXPERIENCE -->
  <section id="experience" class="section experience">
    <h2 class="section-title">Experience</h2>

    <div class="experience-box card exp-context">
      <div class="experience-header">Data Analyst — Fortune Services</div>
      <div class="experience-meta">Aug 2022 – Aug 2023 | Nashik, India</div>
      <div class="experience-details">
        <ul>
          <li>Led data integration projects on AWS S3, Redshift, and dbt to migrate and model 1 TB of marketing and CRM data, enabling predictive analytics that improved campaign ROI by 20%.</li>
          <li>Developed Python ETL pipelines and optimized SQL scripts for multi-channel data aggregation, boosting throughput by 30% and reducing manual effort by 40%.</li>
          <li>Collaborated on Random Forest and Logistic Regression churn models achieving 85%+ accuracy, reducing customer attrition.</li>
        </ul>
      </div>
    </div>

    <div class="experience-box card exp-context">
      <div class="experience-header">Data & Marketing Assistant — Early Identification Program (GMU)</div>
      <div class="experience-meta">Apr 2024 – May 2025 | Fairfax, VA</div>
      <div class="experience-details">
        <ul>
          <li>Built SQL-based migration and ETL pipelines with Redshift & PostgreSQL for 500+ student engagement records, improving accuracy by 25% and cutting pipeline runtime by 40%.</li>
          <li>Power BI/Tableau dashboards with drilldowns, auto-refresh—reduced report prep time by 30%.</li>
          <li>Documented workflows, schemas, and insights; supported 200+ data-driven decisions per quarter.</li>
        </ul>
      </div>
    </div>

    <div class="experience-box card exp-context">
      <div class="experience-header">Data Analyst — Cybeorg Education Technology</div>
      <div class="experience-meta">Jan 2023 – July 2023 | Remote</div>
      <div class="experience-details">
        <ul>
          <li>Automated processing of 2,000+ feedback entries (Python/Pandas) for sentiment and visualization, boosting retention by 12%.</li>
          <li>Ran A/B tests on recommendation algorithms; deployed enhancements via Flask with real-time monitoring.</li>
        </ul>
      </div>
    </div>

    <div class="experience-box card exp-context">
      <div class="experience-header">Data Analyst Trainee — Microsoft & GMU</div>
      <div class="experience-meta">June 2024 – Aug 2024 | Remote</div>
      <div class="experience-details">
        <ul>
          <li>Azure Synapse pipelines for 500GB/day telemetry; cut latency ~40%.</li>
          <li>Power BI dashboards + custom DAX; reduced ad-hoc requests by 50%.</li>
          <li>Basic anomaly detection (Azure ML + Python), reducing incident resolution time by 15%.</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- PROJECTS -->
  <section id="projects" class="section projects">
    <h2 class="section-title">Projects</h2>

    <div class="project-box card proj-context">
      <div class="project-title">AI-Powered Resume Analyzer & Job Matcher</div>
      <div class="project-details">
        <ul>
          <li>Flask app on Google Cloud (Cloud Functions, BigQuery, Cloud Storage) with spaCy for skill extraction, TF-IDF & cosine similarity for job matching &lt;500ms.</li>
          <li>Automated ETL in BigQuery + Cloud Functions APIs; reduced manual matching by 70%.</li>
        </ul>
      </div>
    </div>

    <div class="project-box card proj-context">
      <div class="project-title">Predictive Maintenance Dashboard</div>
      <div class="project-details">
        <ul>
          <li>Python ETL for IoT sensor data → BigQuery; anomaly detection + trends in Power BI.</li>
          <li>XGBoost models on AWS SageMaker (92% precision); alerting via AWS Lambda.</li>
        </ul>
      </div>
    </div>

    <div class="project-box card proj-context">
      <div class="project-title">Smart Door Chat</div>
      <div class="project-details">
        <ul>
          <li>Edge AI on Raspberry Pi 4 using Dart & YOLOv5n for vision; sub-100ms inference; real-time STT; 1st place at GMU Hackathon.</li>
          <li>MQTT + Firebase Cloud Functions/Firestore; ETL logs to BI dashboards for insights.</li>
        </ul>
      </div>
    </div>

    <div class="project-box card proj-context">
      <div class="project-title">Market Basket Analysis</div>
      <div class="project-details">
        <ul>
          <li>Association rules on Instacart dataset (aisle-level co-occurrence). Informs store layout & promos.</li>
          <li><strong>GitHub:</strong> <a href="https://github.com/TheKalyaniMohite/Market-Basket-Analysis" target="_blank">github.com/TheKalyaniMohite/Market-Basket-Analysis</a></li>
        </ul>
      </div>
    </div>
  </section>

  <!-- SKILLS -->
  <section id="skills" class="section skills">
    <h2 class="section-title">Skills</h2>
    <div class="skill-groups">
      <div class="skill-group card skill-context">
        <h3>Languages</h3>
        <div class="skill-tags">
          <span class="tag">Python</span>
          <span class="tag">SQL</span>
          <span class="tag">PostgreSQL</span>
          <span class="tag">R</span>
          <span class="tag">Java</span>
        </div>
      </div>

      <div class="skill-group card skill-context">
        <h3>Tools</h3>
        <div class="skill-tags">
          <span class="tag">Excel</span>
          <span class="tag">Power BI</span>
          <span class="tag">Looker</span>
          <span class="tag">Snowflake</span>
          <span class="tag">Apache Airflow</span>
          <span class="tag">Tableau</span>
          <span class="tag">Git</span>
          <span class="tag">MongoDB</span>
          <span class="tag">dbt</span>
          <span class="tag">Flask</span>
          <span class="tag">Docker</span>
        </div>
      </div>

      <div class="skill-group card skill-context">
        <h3>Libraries</h3>
        <div class="skill-tags">
          <span class="tag">Pandas</span>
          <span class="tag">NumPy</span>
          <span class="tag">OpenCV</span>
          <span class="tag">Scikit-learn</span>
          <span class="tag">TensorFlow</span>
          <span class="tag">PyTorch</span>
          <span class="tag">XGBoost</span>
          <span class="tag">spaCy</span>
          <span class="tag">SHAP</span>
        </div>
      </div>

      <div class="skill-group card skill-context">
        <h3>Cloud Services</h3>
        <div class="skill-tags">
          <span class="tag">Snowflake</span>
          <span class="tag">AWS (EC2, S3, Lambda, RDS, Redshift, CloudWatch, SageMaker)</span>
          <span class="tag">GCP (BigQuery, Cloud Functions, Cloud Storage)</span>
        </div>
      </div>
    </div>
  </section>

  <!-- DASHBOARDS -->
  <section id="dashboards" class="section dashboards">
    <h2 class="section-title">Dashboards</h2>
    <div class="dashboard-card card">
      Your dashboard content goes here. Add Power BI/Tableau links or screenshots!
    </div>
  </section>

  <!-- Back to Top Button -->
  <button class="back-to-top" id="backToTop" title="Back to top">↑</button>

  <!-- Floating AI Button -->
  <button class="floating-ai-button" id="floatingAiButton" title="Ask AI"><span>🤖</span></button>

  <!-- AI Widget -->
  <div class="ai-widget" id="aiWidget" aria-live="polite">
    <div class="ai-header">
      <div class="title">Kalyani’s AI Assistant</div>
      <button class="ai-close" id="aiWidgetClose" aria-label="Close">×</button>
    </div>
    <div class="ai-body" id="aiBody">
      <div class="chat" id="chat"></div>
      <div class="ai-typing" id="typingIndicator">Kalyani’s AI is typing…</div>
    </div>
    <div class="ai-footer">
      <div class="suggestions" id="suggestions">
        <div class="chip">Summarize my profile in 2 lines for a recruiter</div>
        <div class="chip">What is Kalyani’s education?</div>
        <div class="chip">Which project best fits a Data Analyst role?</div>
        <div class="chip">Write a LinkedIn headline for me</div>
        <div class="chip">What are my top skills? (SQL/Power BI/Python)</div>
        <div class="chip">What roles am I best fit for?</div>
      </div>

      <div class="input-row">
        <textarea class="ai-textarea" id="aiTextarea" placeholder="Ask about my experience, projects, education, or skills..." rows="1"></textarea>
        <button class="send-btn" id="sendBtn" title="Send">↗</button>
      </div>

      <div class="sub-row">
        <span style="color: var(--muted); font-size: 0.9rem;">Enter to send • Shift+Enter for newline</span>
        <button class="clear-btn" id="clearChat">Clear chat</button>
      </div>
    </div>
  </div>

  <script>
    // ===== UTILITIES =====
    function formatTS(d = new Date()) {
      return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    }
    function scrollToBottom(el) { el.scrollTop = el.scrollHeight; }

    // ===== BACK TO TOP =====
    (function() {
      const btn = document.getElementById('backToTop');
      window.addEventListener('scroll', () => {
        if (window.scrollY > 250) btn.classList.add('show');
        else btn.classList.remove('show');
      });
      btn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
    })();

    // ===== BUILD PROFILE CONTEXT FROM PAGE =====
    function buildProfileContext() {
      const gatherText = (selector) => {
        return Array.from(document.querySelectorAll(selector))
          .map(el => el.innerText.trim())
          .filter(Boolean)
          .join('\n');
      };
      const education = gatherText('.edu-context');
      const experience = gatherText('.exp-context');
      const projects = gatherText('.proj-context');
      const skills = gatherText('.skill-context');

      return [
        "=== EDUCATION ===",
        education || "(none)",
        "=== EXPERIENCE ===",
        experience || "(none)",
        "=== PROJECTS ===",
        projects || "(none)",
        "=== SKILLS ===",
        skills || "(none)"
      ].join('\n');
    }

    // ===== CHAT STATE =====
    const CHAT_KEY = 'km_chat_history_v2';
    function loadHistory() {
      try {
        const raw = localStorage.getItem(CHAT_KEY);
        return raw ? JSON.parse(raw) : [];
      } catch {
        return [];
      }
    }
    function saveHistory(hist) {
      localStorage.setItem(CHAT_KEY, JSON.stringify(hist));
    }

    // ===== RENDER CHAT =====
    function renderChat(chatEl, hist) {
      chatEl.innerHTML = '';
      hist.forEach(msg => {
        const div = document.createElement('div');
        div.className = 'bubble ' + (msg.role === 'user' ? 'user' : 'ai');
        div.textContent = msg.content;
        const ts = document.createElement('div');
        ts.className = 'ts';
        ts.textContent = msg.ts || formatTS();
        div.appendChild(ts);
        chatEl.appendChild(div);
      });
    }

    // ===== TYPEWRITER EFFECT =====
    async function typewriterAppend(chatEl, text, ts) {
      const bubble = document.createElement('div');
      bubble.className = 'bubble ai';
      const tsEl = document.createElement('div');
      tsEl.className = 'ts'; tsEl.textContent = ts || formatTS();
      bubble.appendChild(tsEl);
      chatEl.appendChild(bubble);

      let i = 0;
      const chunk = () => {
        const next = text.slice(0, i += Math.max(1, Math.floor(text.length / 120)));
        bubble.firstChild && bubble.removeChild(tsEl); // keep ts at end
        bubble.textContent = next;
        bubble.appendChild(tsEl);
        scrollToBottom(chatEl.parentElement);
        if (i < text.length) requestAnimationFrame(chunk);
      };
      requestAnimationFrame(chunk);
    }

    // ===== AI WIDGET =====
    (function() {
      const btn = document.getElementById('floatingAiButton');
      const widget = document.getElementById('aiWidget');
      const closeBtn = document.getElementById('aiWidgetClose');
      const chatEl = document.getElementById('chat');
      const typingIndicator = document.getElementById('typingIndicator');
      const textarea = document.getElementById('aiTextarea');
      const sendBtn = document.getElementById('sendBtn');
      const clearBtn = document.getElementById('clearChat');
      const suggestionsEl = document.getElementById('suggestions');
      const aiBody = document.getElementById('aiBody');

      let hist = loadHistory();
      let profileContext = '';

      // init
      profileContext = buildProfileContext();
      renderChat(chatEl, hist);
      setTimeout(() => scrollToBottom(aiBody), 50);

      // open/close
      function toggleWidget() {
        widget.classList.toggle('open');
        if (widget.classList.contains('open')) {
          setTimeout(() => textarea.focus(), 100);
        }
      }
      btn.addEventListener('click', toggleWidget);
      closeBtn.addEventListener('click', () => widget.classList.remove('open'));

      // textarea auto-grow
      function autoGrow() {
        textarea.style.height = 'auto';
        textarea.style.height = Math.min(textarea.scrollHeight, 160) + 'px';
      }
      textarea.addEventListener('input', autoGrow);
      autoGrow();

      // suggestions
      suggestionsEl.addEventListener('click', (e) => {
        const chip = e.target.closest('.chip');
        if (!chip) return;
        textarea.value = chip.textContent;
        autoGrow();
        sendMessage();
      });

      // enter to send, shift+enter newline
      textarea.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          sendMessage();
        }
      });
      sendBtn.addEventListener('click', sendMessage);

      // clear chat
      clearBtn.addEventListener('click', () => {
        hist = [];
        saveHistory(hist);
        renderChat(chatEl, hist);
      });

      // send
      async function sendMessage() {
        const q = textarea.value.trim();
        if (!q) return;

        // add user bubble
        const userMsg = { role: 'user', content: q, ts: formatTS() };
        hist.push(userMsg);
        saveHistory(hist);
        renderChat(chatEl, hist);
        scrollToBottom(aiBody);

        // clear input
        textarea.value = '';
        autoGrow();

        // show typing
        typingIndicator.classList.add('show');

        try {
          const resp = await fetch('/api/ask', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              question: q,
              context: profileContext
            })
          });

          const data = await resp.json();
          const answer = data.answer || '(No answer)';

          // typing effect
          await typewriterAppend(chatEl, answer, formatTS());

          const aiMsg = { role: 'assistant', content: answer, ts: formatTS() };
          hist.push(aiMsg);
          saveHistory(hist);

        } catch (err) {
          const errMsg = 'Error: ' + (err.message || 'Request failed');
          await typewriterAppend(chatEl, errMsg, formatTS());
          hist.push({ role: 'assistant', content: errMsg, ts: formatTS() });
          saveHistory(hist);
        } finally {
          typingIndicator.classList.remove('show');
          scrollToBottom(aiBody);
        }
      }
    })();

    // Highlight nav on scroll
    (function(){
      const links = document.querySelectorAll('.main-top-nav li');
      const sections = ['home','education','experience','projects','skills','dashboards']
        .map(id => document.getElementById(id)).filter(Boolean);

      function onScroll() {
        const y = window.scrollY + 120;
        let current = sections[0]?.id;
        sections.forEach(sec => {
          if (sec.offsetTop <= y) current = sec.id;
        });
        links.forEach(li => {
          const a = li.querySelector('a');
          li.classList.toggle('active', a && a.getAttribute('href') === '#' + current);
        });
      }
      window.addEventListener('scroll', onScroll);
      onScroll();
    })();
  </script>
</body>
</html>
